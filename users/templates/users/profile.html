{% extends "layouts/d.html" %}
{% load static %}
{% block content %}
 




<div class=" position-relative shadow mx-auto p-2 rounded-2 col-md-6 text-center">
    <img class="object-fit-cover profile-image rounded-circle" src="{{profile.avatar}}" alt="{{profile.name}}">
    <h2 class="mt-2">{{profile.name}}</h2>
    <div class="mt-2 text-secondary">@{{profile.user.username}}</div>
    {% if profile.location %}
        <div class="mt-2"><i class="bi bi-geo-alt-fill me-2"></i>{{profile.location}}</div>
    {% endif %}
    {% if profile.bio %}
        <p class="mt-2">{{profile.bio}}</p>
    {% endif %}
    {% if user != profile.user %}
        <div class="position-absolute end-0 bottom-0 ">
            <button type="button" class=" btn btn-outline-secondary rounded-circle me-2 mb-2" data-bs-toggle="modal" data-bs-target="#send-message">
                <i class="bi bi-envelope-arrow-up-fill"></i>
            </button>
        </div>
        <div class="modal fade" id="send-message" tabindex="-1" aria-labelledby="send-messageLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="send-messageLabel">Send Message</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                    {% include "inbox/create_message.html" with recipient=profile.user%}
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
 </div>
 <div class="mt-4 text-center" 
    hx-target="#profile-posts"
    hx-swap="outerHTML"
    _="on htmx:afterOnLoad take .active for event.target"

    >
    <button hx-get="{% url "user-profile" profile.user.username %}" class="btn btn-outline-secondary active">Latest</button>
    <button hx-get="{% url "user-profile" profile.user.username%}?top_posts" class="btn btn-outline-secondary">Top Posts</button>
    <button hx-get="{% url "user-profile" profile.user.username%}?top_comments" class="btn btn-outline-secondary">Top Comments</button>
    <button hx-get="{% url "user-profile" profile.user.username%}?liked_posts" class="btn btn-outline-secondary">Liked Posts</button>
</div>
<div id="profile-posts" class="col-md-10 mx-md-auto row align-items-stretch mt-3 gy-3 row-cols-1
    {% if profile.user.posts.count >= 3%}
    row-cols-sm-2 g-sm-3 row-cols-lg-3 
    {% elif profile.user.posts.count == 2 %}
    row-cols-sm-2 g-sm-3
    {% endif %} ">
    {% if profile.user.posts %}
        {% for post in profile.user.posts.all %}
        <div class="col d-flex flex-grow-0 align-items-stretch">
            {% include "posts/post.html" with post=post%}
        </div>
        {% endfor %}
    {% else %}
    <p class="text-center">There is no posts</p>
    {% endif %}
    
</div>

{% endblock content %}